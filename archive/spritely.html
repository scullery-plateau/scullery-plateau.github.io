<html>
  <head>
    <title>Scullery Plateau: Spritely</title>
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css"
    />
    <link
      href="https://fonts.googleapis.com/css?family=Caudex"
      rel="stylesheet"
    />
    <link
      href="https://fonts.googleapis.com/css?family=Modern+Antiqua"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="../style/rpg.css" />
    <link rel="stylesheet" href="../style/font.css" />
    <link rel="stylesheet" href="../style/menu.css" />
    <style type="text/css">
      #canvas {
        min-width: 90%;
        min-height: 80%;
        position: relative;
      }
      #canvas > svg {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
      }
      .palette-color {
        border: 2px solid black;
      }
      .selected-color {
        border: 4px solid white;
      }
      #sizePicker a {
      }
      #sizePicker a.disabled,
      #sizePicker a:disabled {
        color: darkgrey !important;
      }
    </style>
    <script type="text/javascript" src="scripts/keyeventwrapper.js"></script>
    <script type="text/javascript" src="scripts/colorPicker.js"></script>
    <script type="text/javascript" src="scripts/colors.js"></script>
    <script type="text/javascript" src="scripts/download.js"></script>
    <script type="text/javascript" src="scripts/fileload.js"></script>
    <script type="text/javascript" src="scripts/jval.js"></script>
    <script type="text/javascript" src="scripts/menues.js"></script>
    <script type="text/javascript" src="scripts/popup.js"></script>
    <script type="text/javascript" src="scripts/spritely.js"></script>
    <script type="text/javascript" src="scripts/template.js"></script>
    <script type="text/javascript" src="scripts/triggers.js"></script>
    <script type="text/javascript" src="scripts/trim-bounds.js"></script>
  </head>
  <body
    class="bg-dark text-light"
    onload="init(
      'clearedPixel',
      'backgroundColor',
      'makeTransparent',
      'palette',
      'paletteDefs',
      'paletteColor',
      'canvas',
      'about',
      'imageDownload',
      'imageScale','trimToImage','htmlcanvas','imageFileName','imageLink','imageDisplay','fileLoad',
      'colorPicker','hexColor','hexPaletteTable','colorByName','redColor','greenColor','blueColor','hexColorDisplay'
      )"
    onclick="closeStrayMenu(event)"
  >
    <svg width="0" height="0">
      <defs>
        <linearGradient
          id="clearedGradient"
          x1="0%"
          y1="0%"
          x2="100%"
          y2="100%"
        >
          <stop offset="5%" style="stop-color: #ff0000; stop-opacity: 0.2" />
          <stop offset="23%" style="stop-color: #ffff00; stop-opacity: 0.2" />
          <stop offset="41%" style="stop-color: #00ff00; stop-opacity: 0.2" />
          <stop offset="59%" style="stop-color: #00ffff; stop-opacity: 0.2" />
          <stop offset="77%" style="stop-color: #0000ff; stop-opacity: 0.2" />
          <stop offset="95%" style="stop-color: #ff00ff; stop-opacity: 0.2" />
        </linearGradient>
        <rect
          id="clearedPixel"
          width="10"
          height="10"
          stroke-width="1"
          stroke="black"
          fill="url(#clearedGradient)"
        />
      </defs>
    </svg>
    <div class="container">
      <div class="navbar justify-content-start">
        <div class="mr-3">
          <ul class="navbar-nav">
            <li class="nav-item active drowpdown">
              <a
                href="#"
                class="rpg-box p-3 text-light nav-link dropdown-toggle"
                onclick="toggleMenu(event,this)"
              ></a>
              <ul class="dropdown-menu rpg-box">
                <li class="dropdown-submenu">
                  <a
                    href="#"
                    class="dropdown-item dropdown-toggle"
                    onclick="toggleMenu(event,this)"
                    >File</a
                  >
                  <ul class="dropdown-menu rpg-box">
                    <li class="">
                      <a
                        href="#"
                        class="dropdown-item"
                        onclick="loadFile(event)"
                        >Load File</a
                      >
                    </li>
                    <li class="">
                      <a
                        href="#"
                        class="dropdown-item"
                        onclick="showImageDownload(event)"
                        >Download</a
                      >
                    </li>
                  </ul>
                </li>
                <li class="dropdown-submenu">
                  <a
                    href="#"
                    class="dropdown-item dropdown-toggle"
                    onclick="toggleMenu(event,this)"
                    >Size</a
                  >
                  <ul class="dropdown-menu rpg-box" id="sizePicker">
                    <li class="">
                      <a
                        id="size16"
                        href="#"
                        class="dropdown-item disabled"
                        disabled
                        onclick="setSize(16,event)"
                        >16 x 16</a
                      >
                    </li>
                    <li class="">
                      <a
                        id="size32"
                        href="#"
                        class="dropdown-item"
                        disabled
                        onclick="setSize(32,event)"
                        >32 x 32</a
                      >
                    </li>
                    <li class="">
                      <a
                        id="size48"
                        href="#"
                        class="dropdown-item"
                        disabled
                        onclick="setSize(48,event)"
                        >48 x 48</a
                      >
                    </li>
                  </ul>
                </li>
                <li class="dropdown-submenu">
                  <a
                    href="#"
                    class="dropdown-item dropdown-toggle"
                    onclick="toggleMenu(event,this)"
                    >Transform</a
                  >
                  <ul class="dropdown-menu rpg-box">
                    <li class="">
                      <a
                        href="#"
                        class="dropdown-item"
                        onclick="transform('turnLeft',event)"
                        >Turn Left (CTRL + Left Arrow)</a
                      >
                    </li>
                    <li class="">
                      <a
                        href="#"
                        class="dropdown-item"
                        onclick="transform('turnRight',event)"
                        >Turn Right (CTRL + Right Arrow)</a
                      >
                    </li>
                    <li class="">
                      <a
                        href="#"
                        class="dropdown-item"
                        onclick="transform('flipOver',event)"
                        >Flip Over (CTRL + Up Arrow)</a
                      >
                    </li>
                    <li class="">
                      <a
                        href="#"
                        class="dropdown-item"
                        onclick="transform('flipDown',event)"
                        >Flip Down (CTRL + Down Arrow)</a
                      >
                    </li>
                    <li class="">
                      <a
                        href="#"
                        class="dropdown-item"
                        onclick="transform('shiftLeft',event)"
                        >Shift Left (SHIFT + Left Arrow)</a
                      >
                    </li>
                    <li class="">
                      <a
                        href="#"
                        class="dropdown-item"
                        onclick="transform('shiftRight',event)"
                        >Shift Right (SHIFT + Right Arrow)</a
                      >
                    </li>
                    <li class="">
                      <a
                        href="#"
                        class="dropdown-item"
                        onclick="transform('shiftUp',event)"
                        >Shift Up (SHIFT + Up Arrow)</a
                      >
                    </li>
                    <li class="">
                      <a
                        href="#"
                        class="dropdown-item"
                        onclick="transform('shiftDown',event)"
                        >Shift Down (SHIFT + Down Arrow)</a
                      >
                    </li>
                  </ul>
                </li>
                <li class="">
                  <a href="#" class="dropdown-item" onclick="showAbout(event)"
                    >About</a
                  >
                </li>
              </ul>
            </li>
          </ul>
        </div>
        <a href="index.html" class="navbar-brand text-light"
          >Scullery Plateau:</a
        >
        <span class="navbar-brand">Spritely</span>
      </div>
      <div class="d-flex justify-content-center rpg-box m-3">
        <button
          class="rounded w-25"
          id="backgroundColor"
          onclick="setBackgroundColor(this)"
        >
          BG Color
        </button>
        <span class="m-3"></span>
        <button
          class="rounded w-25 btn btn-outline-light"
          id="makeTransparent"
          onclick="toggleTransparent(this)"
        >
          Transparent
        </button>
      </div>
      <div class="rpg-box m-3 d-flex justify-content-between" title="Palette">
        <button class="btn btn-success" title="Add Color" onclick="addColor()">
          +
        </button>
        <div id="palette" class="ml-2 w-100 d-flex flex-wrap"></div>
        <button
          class="btn btn-danger"
          title="Remove Selected Color"
          onclick="removeColor()"
        >
          X
        </button>
      </div>
      <div
        id="canvas"
        class="rpg-title-box m-3"
        title="click to paint a pixel"
      ></div>
    </div>
    <footer class="text-center">
      <p>Built by Daniel Allen Johnson &#169; 2019 - 2022</p>
      <p>
        <a
          href="https://github.com/scullery-plateau/scullery-plateau.github.io"
          class="btn btn-outline-info"
          >See the code on GitHub.</a
        >
      </p>
    </footer>
    <div style="display: none">
      <div id="paletteDefs"></div>
      <input
        id="fileLoad"
        type="file"
        accept=".json,application/json"
        onchange="loadFiles(event)"
      />
      <input id="paletteColor" type="color" />
      <div id="about">
        <p>Spritely is a canvas for pixel art.</p>
        <p>
          Build your palette below, then select a color in the palette to paint
          pixels that color, or to unpaint pixels already that color.
        </p>
        <p>
          Changing the color of a slot in the palette will change the color of
          all matching pixels.
        </p>
        <p>Deleting a color will unpaint all pixels that matching color.</p>
        <p>Unpainting pixels will return them to the background color.</p>
      </div>
      <div id="imageDownload">
        <div>
          <div id="imageDisplay" style="display: none">
            <canvas
              id="htmlcanvas"
              width="${imgDim}"
              height="${imgDim}"
            ></canvas>
          </div>
          <div class="form-group">
            <label for="imageFileName">File Name:</label>
            <input
              type="text"
              class="form-control"
              id="imageFileName"
              placeholder="spritely"
              onchange="repaintImage()"
            />
          </div>
          <div class="form-group">
            <label for="imageScale">Image Scale:</label>
            <input
              type="number"
              value="5"
              min="1"
              class="form-control"
              id="imageScale"
              onchange="repaintImage()"
            />
          </div>
          <div class="form-check">
            <label for="trimToImage" class="form-check-label">Trim To Image?</label>
            <input type="checkbox"
                   class="form-check-input"
                   id="trimToImage"
                   onchange="repaintImage()"/>
          </div>
          <p>Click on the image to download.</p>
          <div id="imageLink">
            <a
              href="${dataURL}"
              title="click image to download"
              download="${filename}"
            >
              <img
                src="${dataURL}"
                style="width: ${imgDim}; height: ${imgDim};"
              />
            </a>
          </div>
        </div>
      </div>
      <div id="colorPicker">
        <div class="d-flex justify-content-center">
          <div id="hexPaletteTable" class="p-2"></div>
          <div class="d-flex flex-column p-2">
            <p id="hexColorDisplay" class="rounded-lg">__</p>
            <div class="form-group">
              <label for="hexColor">Color Hexcode:</label>
              <input
                type="text"
                class="form-control"
                id="hexColor"
                onchange="setRGB(this.value)"
              />
            </div>
            <div class="form-group">
              <label for="colorByName">Color by Name</label>
              <select
                id="colorByName"
                class="form-control"
                onchange="setRGB(this.options[this.selectedIndex].value)"
              ></select>
            </div>
            <hr />
            <div class="d-flex">
              <div class="form-group">
                <label for="redColor">Red:</label>
                <input
                  type="number"
                  min="0"
                  max="255"
                  class="form-control"
                  id="redColor"
                  onchange="setColorPart({red:this.value})"
                />
              </div>
              <div class="form-group">
                <label for="greenColor">Green:</label>
                <input
                  type="number"
                  min="0"
                  max="255"
                  class="form-control"
                  id="greenColor"
                  onchange="setColorPart({green:this.value})"
                />
              </div>
              <div class="form-group">
                <label for="blueColor">Blue:</label>
                <input
                  type="number"
                  min="0"
                  max="255"
                  class="form-control"
                  id="blueColor"
                  onchange="setColorPart({blue:this.value})"
                />
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </body>
</html>
